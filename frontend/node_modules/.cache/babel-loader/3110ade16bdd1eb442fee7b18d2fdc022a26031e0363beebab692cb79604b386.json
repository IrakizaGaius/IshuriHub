{"ast":null,"code":"import React,{useState,useEffect}from'react';import'bootstrap/dist/css/bootstrap.min.css';import'@fortawesome/fontawesome-free/css/all.min.css';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faBell,faUsers,faGraduationCap,faCalendarAlt,faUserCheck,faUserGraduate,faBars,faDownload,faDashboard,faSignOut,faCalendarCheck,faCog}from'@fortawesome/free-solid-svg-icons';import{Link,useParams}from'react-router-dom';import'./StudentDetails.css';import{getSubjects,getStudent,getTerms,addMarks,getMarks,getAttendance,addAttendance}from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const StudentDetailsPage=()=>{const{id}=useParams();const[subjects,setSubjects]=useState([]);const[marks,setMarks]=useState({});const[currentTerm,setCurrentTerm]=useState(null);const[isMarksModalOpen,setIsMarksModalOpen]=useState(false);const[selectedStudent,setSelectedStudent]=useState(null);const[newMarkData,setNewMarkData]=useState({subject:'',testType:'',markPercentage:''});const[attendance,setAttendance]=useState([]);const[isAttendanceModalOpen,setIsAttendanceModalOpen]=useState(false);const[newAttendance,setNewAttendance]=useState({date:'',status:''});const formatDate=dateString=>{const options={year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit'};return new Date(dateString).toLocaleDateString(undefined,options);};// Retrieve user data from localStorage\nconst username=localStorage.getItem('username');const email=localStorage.getItem('email');const[terms,setTerms]=useState([]);// Side menu state\nconst[menuOpen,setMenuOpen]=useState(false);// State for the notification message\nconst[notification,setNotification]=useState({message:'',type:''});// Profile dropdown state\nconst[showProfileDropdown,setShowProfileDropdown]=useState(false);// Handle profile dropdown toggle\nconst toggleProfileDropdown=()=>{setShowProfileDropdown(!showProfileDropdown);};// Toggle side menu\nconst toggleMenu=()=>{setMenuOpen(!menuOpen);};const closeNotification=()=>{setNotification({message:'',type:''});};// Logout function\nconst handleLogout=async()=>{try{await logout();localStorage.removeItem('username');localStorage.removeItem('email');// Redirect to the index page\nwindow.location.href='/';}catch(error){console.error(\"Logout failed:\",error);}};const fetchMarksForStudent=async()=>{try{const rawMarks=await getMarks(selectedStudent.id,currentTerm.id);const structuredMarks=rawMarks.reduce((acc,mark)=>{const{StudentId,Subject,testType,marks}=mark;if(!acc[StudentId])acc[StudentId]={};if(!acc[StudentId][currentTerm.id])acc[StudentId][currentTerm.id]={};if(!acc[StudentId][currentTerm.id][Subject.name]){acc[StudentId][currentTerm.id][Subject.name]={test:0,exam:0};}acc[StudentId][currentTerm.id][Subject.name][testType]=marks;return acc;},{});setMarks(structuredMarks);}catch(error){console.error(\"Error fetching marks:\",error);}};useEffect(()=>{const fetchAttendance=async()=>{if(!selectedStudent||!currentTerm)return;try{const attendanceData=await getAttendance(selectedStudent.id,currentTerm.id);setAttendance(attendanceData);}catch(error){console.error(\"Error fetching attendance:\",error);}};fetchAttendance();},[selectedStudent,currentTerm]);// Handle attendance submission\nconst handleAttendanceSubmit=async e=>{e.preventDefault();try{const recordedAttendance=await addAttendance({studentId:selectedStudent.id,termId:currentTerm.id,date:newAttendance.date,status:newAttendance.status});setAttendance(prev=>[...prev,recordedAttendance]);setIsAttendanceModalOpen(false);setNotification({message:'Attendance recorded successfully!',type:'success'});setNewAttendance({date:'',status:''});}catch(error){console.error(\"Error recording attendance:\",error);}};const displayedAttendance=attendance.filter(entry=>entry.studentId===(selectedStudent===null||selectedStudent===void 0?void 0:selectedStudent.id)&&entry.termId===(currentTerm===null||currentTerm===void 0?void 0:currentTerm.id));useEffect(()=>{const fetchInitialData=async()=>{try{const student=await getStudent(id);setSelectedStudent(student);const subjects=await getSubjects();setSubjects(subjects);const termDetails=await getTerms();setTerms(termDetails);const now=new Date();const activeTerm=termDetails.find(term=>new Date(term.startDate)<=now&&now<=new Date(term.endDate));setCurrentTerm(activeTerm||termDetails[0]);}catch(error){console.error('Error fetching data:',error);}};fetchInitialData();},[id]);const handleSubjectChange=e=>{const selectedSubject=subjects.find(subject=>subject.name===e.target.value);setNewMarkData({...newMarkData,subject:selectedSubject});};const handleMarksSubmit=async e=>{e.preventDefault();if(!selectedStudent||!newMarkData.subject||!newMarkData.subject.id){return;}try{await addMarks({studentId:selectedStudent.id,subjectId:newMarkData.subject.id,testType:newMarkData.testType,marks:newMarkData.markPercentage});await fetchMarksForStudent();setIsMarksModalOpen(false);setNotification({message:'Marks added successfully!',type:'success'});setNewMarkData({subject:'',testType:'',markPercentage:''});}catch(error){console.error('Error adding marks:',error);}};useEffect(()=>{if(selectedStudent&&currentTerm){fetchMarksForStudent();}},[selectedStudent,currentTerm]);const calculateSubjectTotal=subjectMarks=>{const testMarks=(subjectMarks===null||subjectMarks===void 0?void 0:subjectMarks.test)||0;const examMarks=(subjectMarks===null||subjectMarks===void 0?void 0:subjectMarks.exam)||0;return(testMarks+examMarks)/2;};const handleExportReport=()=>{if(!selectedStudent||!currentTerm){alert(\"No data available to export.\");return;}const headers=[\"Student Name\",\"Subject\",\"Test\",\"Exam\",\"Term Total\"];const rows=subjects.map(subject=>{var _marks$selectedStuden,_marks$selectedStuden2;const subjectMarks=((_marks$selectedStuden=marks[selectedStudent.id])===null||_marks$selectedStuden===void 0?void 0:(_marks$selectedStuden2=_marks$selectedStuden[currentTerm.id])===null||_marks$selectedStuden2===void 0?void 0:_marks$selectedStuden2[subject.name])||{};const testMarks=subjectMarks.test||\"-\";const examMarks=subjectMarks.exam||\"-\";const subjectTotal=calculateSubjectTotal(subjectMarks);return[selectedStudent.name,subject.name,testMarks,examMarks,subjectTotal||\"-\"];});const overallTotal=subjects.reduce((total,subject)=>{var _marks$selectedStuden3,_marks$selectedStuden4;const subjectMarks=((_marks$selectedStuden3=marks[selectedStudent.id])===null||_marks$selectedStuden3===void 0?void 0:(_marks$selectedStuden4=_marks$selectedStuden3[currentTerm.id])===null||_marks$selectedStuden4===void 0?void 0:_marks$selectedStuden4[subject.name])||{};return total+calculateSubjectTotal(subjectMarks);},0);rows.push([\"\",\"Overall Total\",\"\",\"\",overallTotal]);const csvContent=[headers,...rows].map(row=>row.join(\",\")).join(\"\\n\");const blob=new Blob([csvContent],{type:\"text/csv\"});const url=URL.createObjectURL(blob);const link=document.createElement(\"a\");link.href=url;link.download=`report_${currentTerm.name}_${selectedStudent.name}.csv`;document.body.appendChild(link);link.click();document.body.removeChild(link);};return/*#__PURE__*/_jsxs(\"div\",{className:\"StudentDetails-wrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:`side-menu ${menuOpen?'open':''}`,children:[/*#__PURE__*/_jsx(\"button\",{className:\"menu-toggle\",onClick:toggleMenu,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faBars})}),/*#__PURE__*/_jsx(\"div\",{className:\"menu-icons\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(Link,{to:\"/dashboard\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faDashboard,className:\"Dashboard-icon\"}),\" \",menuOpen&&/*#__PURE__*/_jsx(\"span\",{children:\"Dashboard\"})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(Link,{to:\"/students\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faGraduationCap,className:\"Students-icon\"}),\" \",menuOpen&&/*#__PURE__*/_jsx(\"span\",{children:\"Students\"})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(Link,{to:\"/events\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCalendarAlt,className:\"Events-icon\"}),\" \",menuOpen&&/*#__PURE__*/_jsx(\"span\",{children:\"Events\"})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(Link,{to:\"/parents\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUsers,className:\"Parents-icon\"}),\" \",menuOpen&&/*#__PURE__*/_jsx(\"span\",{children:\"Parents\"})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(Link,{to:\"/config\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCog,className:\"Config-icon\"}),\" \",menuOpen&&/*#__PURE__*/_jsx(\"span\",{children:\"Configurations\"})]})}),/*#__PURE__*/_jsxs(\"li\",{onClick:toggleProfileDropdown,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUserCheck,className:\"Profile-icon\",style:{color:'white'}}),menuOpen&&/*#__PURE__*/_jsx(\"span\",{children:\"Profile\"})]}),/*#__PURE__*/_jsxs(\"li\",{onClick:handleLogout,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faSignOut,className:\"Register-icon\",style:{color:'white'}}),menuOpen&&/*#__PURE__*/_jsx(\"span\",{children:\"Logout\"})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:`StudentDetails-container ${menuOpen?'blur':''}`,children:[notification.message&&/*#__PURE__*/_jsx(\"div\",{className:`notification ${notification.type}`,style:{top:notification.message?'100px':'-60px'},children:notification.message}),notification.message&&setTimeout(closeNotification,3000),/*#__PURE__*/_jsx(\"header\",{className:\"StudentDetails-header\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"StudentDetails-title\",children:\"Student Details\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-container\",onClick:toggleProfileDropdown,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUserCheck,className:\"profile-icon\"}),showProfileDropdown&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-dropdown\",children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"UserName: \",username]})}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"Email: \",email]})}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-button\",onClick:handleLogout,children:\"Logout\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"student-details-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:currentTerm?`Current Term: ${currentTerm.name}`:'No Active Term'}),/*#__PURE__*/_jsx(\"div\",{className:\"add-marks-button-container\",children:/*#__PURE__*/_jsx(\"button\",{className:\"add-marks-button\",onClick:()=>setIsMarksModalOpen(true),children:\" + Add Marks\"})}),/*#__PURE__*/_jsxs(\"button\",{className:\"export-report-button\",onClick:handleExportReport,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faDownload}),\" Export\"]}),isMarksModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"marks-popup-form\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"marks-form-container\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Add Marks for \",selectedStudent===null||selectedStudent===void 0?void 0:selectedStudent.name]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleMarksSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"marks-form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Subject\"}),/*#__PURE__*/_jsxs(\"select\",{value:newMarkData.subject?newMarkData.subject.name:\"\",onChange:handleSubjectChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:\"Select Subject\"}),subjects.map(subject=>/*#__PURE__*/_jsx(\"option\",{value:subject.name,children:subject.name},subject.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"marks-form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"testType\",children:\"Test Type\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"testType\",value:newMarkData.testType||\"\",onChange:e=>setNewMarkData({...newMarkData,testType:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:\"Select Test Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"test\",children:\"Test\"}),/*#__PURE__*/_jsx(\"option\",{value:\"exam\",children:\"Exam\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"marks-form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Mark Percentage\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:newMarkData.markPercentage,onChange:e=>{// Convert input value to a float number and set it\nconst value=parseFloat(e.target.value);// Check if the value is a valid number (NaN is returned for invalid inputs)\nif(!isNaN(value)&&value>=0&&value<=100){setNewMarkData({...newMarkData,markPercentage:value});}},min:\"0\",max:\"100\",step:\"0.01\"// Allow float input by defining step\n})]}),/*#__PURE__*/_jsx(\"div\",{className:\"marks-form-actions\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Save\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"marks-form-close\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-close\",onClick:()=>{setNewMarkData({subject:\"\",testType:\"\",markPercentage:\"\"});setIsMarksModalOpen(false);}})})]})}),isAttendanceModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"attendance-popup-form\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-form-container\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Attendance for \",selectedStudent===null||selectedStudent===void 0?void 0:selectedStudent.name]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAttendanceSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:newAttendance.date||\"\",min:currentTerm===null||currentTerm===void 0?void 0:currentTerm.startDate.split('T')[0],max:currentTerm===null||currentTerm===void 0?void 0:currentTerm.endDate.split('T')[0],onChange:e=>setNewAttendance({...newAttendance,date:e.target.value}),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:newAttendance.status||\"\",onChange:e=>setNewAttendance({...newAttendance,status:e.target.value}),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,children:\"Select Status\"}),/*#__PURE__*/_jsx(\"option\",{value:\"PRESENT\",children:\"PRESENT\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ABSENT\",children:\"ABSENT\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"attendance-form-actions\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Save\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"attendance-form-close\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-close\",onClick:()=>{setNewAttendance({date:\"\",status:\"\"});setIsAttendanceModalOpen(false);}})})]})}),currentTerm?/*#__PURE__*/_jsxs(\"div\",{className:\"term-report\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Report for \",currentTerm.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Duration: \",formatDate(currentTerm.startDate),\" To \",formatDate(currentTerm.endDate)]}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Student Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Subject\"}),/*#__PURE__*/_jsx(\"th\",{children:\" Test (%)\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Exam (%)\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Term Total(%)\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:subjects.map((subject,index)=>{var _marks$selectedStuden5,_marks$selectedStuden6;const subjectMarks=((_marks$selectedStuden5=marks[selectedStudent===null||selectedStudent===void 0?void 0:selectedStudent.id])===null||_marks$selectedStuden5===void 0?void 0:(_marks$selectedStuden6=_marks$selectedStuden5[currentTerm===null||currentTerm===void 0?void 0:currentTerm.id])===null||_marks$selectedStuden6===void 0?void 0:_marks$selectedStuden6[subject.name])||{};const subjectTotal=calculateSubjectTotal(subjectMarks);return/*#__PURE__*/_jsxs(\"tr\",{children:[index===0&&/*#__PURE__*/_jsx(\"td\",{rowSpan:subjects.length,children:selectedStudent.name}),/*#__PURE__*/_jsx(\"td\",{children:subject.name}),/*#__PURE__*/_jsx(\"td\",{children:subjectMarks.test||'-'}),/*#__PURE__*/_jsx(\"td\",{children:subjectMarks.exam||'-'}),/*#__PURE__*/_jsx(\"td\",{children:subjectTotal||'-'})]},`${selectedStudent.id}-${subject.id}`);})}),/*#__PURE__*/_jsx(\"tfoot\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{colSpan:\"4\",style:{textAlign:'right'},children:\"Overall Total\"}),/*#__PURE__*/_jsxs(\"td\",{children:[parseFloat((subjects.reduce((total,subject)=>{var _marks$selectedStuden7,_marks$selectedStuden8;const subjectMarks=((_marks$selectedStuden7=marks[selectedStudent===null||selectedStudent===void 0?void 0:selectedStudent.id])===null||_marks$selectedStuden7===void 0?void 0:(_marks$selectedStuden8=_marks$selectedStuden7[currentTerm===null||currentTerm===void 0?void 0:currentTerm.id])===null||_marks$selectedStuden8===void 0?void 0:_marks$selectedStuden8[subject.name])||{};return total+calculateSubjectTotal(subjectMarks);},0)/14).toFixed(2)),\"%\"]})]})})]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No active term is currently ongoing.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-section\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Attendance for \",currentTerm===null||currentTerm===void 0?void 0:currentTerm.name]}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:displayedAttendance.length>0?displayedAttendance.map((entry,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:new Date(entry.date).toLocaleDateString('en-US',{weekday:'short',// E.g., \"Thu\"\nyear:'numeric',month:'long',// E.g., \"November\"\nday:'2-digit'})}),/*#__PURE__*/_jsx(\"td\",{style:{color:entry.status==='PRESENT'?'green':'red'},children:entry.status})]},index)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"2\",children:\"No attendance records found.\"})})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"record-attendance-button\",onClick:()=>setIsAttendanceModalOpen(true),children:\" + Record Attendance\"})]})]})]})]});};export default StudentDetailsPage;","map":{"version":3,"names":["React","useState","useEffect","FontAwesomeIcon","faBell","faUsers","faGraduationCap","faCalendarAlt","faUserCheck","faUserGraduate","faBars","faDownload","faDashboard","faSignOut","faCalendarCheck","faCog","Link","useParams","getSubjects","getStudent","getTerms","addMarks","getMarks","getAttendance","addAttendance","jsx","_jsx","jsxs","_jsxs","StudentDetailsPage","id","subjects","setSubjects","marks","setMarks","currentTerm","setCurrentTerm","isMarksModalOpen","setIsMarksModalOpen","selectedStudent","setSelectedStudent","newMarkData","setNewMarkData","subject","testType","markPercentage","attendance","setAttendance","isAttendanceModalOpen","setIsAttendanceModalOpen","newAttendance","setNewAttendance","date","status","formatDate","dateString","options","year","month","day","hour","minute","Date","toLocaleDateString","undefined","username","localStorage","getItem","email","terms","setTerms","menuOpen","setMenuOpen","notification","setNotification","message","type","showProfileDropdown","setShowProfileDropdown","toggleProfileDropdown","toggleMenu","closeNotification","handleLogout","logout","removeItem","window","location","href","error","console","fetchMarksForStudent","rawMarks","structuredMarks","reduce","acc","mark","StudentId","Subject","name","test","exam","fetchAttendance","attendanceData","handleAttendanceSubmit","e","preventDefault","recordedAttendance","studentId","termId","prev","displayedAttendance","filter","entry","fetchInitialData","student","termDetails","now","activeTerm","find","term","startDate","endDate","handleSubjectChange","selectedSubject","target","value","handleMarksSubmit","subjectId","calculateSubjectTotal","subjectMarks","testMarks","examMarks","handleExportReport","alert","headers","rows","map","_marks$selectedStuden","_marks$selectedStuden2","subjectTotal","overallTotal","total","_marks$selectedStuden3","_marks$selectedStuden4","push","csvContent","row","join","blob","Blob","url","URL","createObjectURL","link","document","createElement","download","body","appendChild","click","removeChild","className","children","onClick","icon","to","style","color","top","setTimeout","onSubmit","onChange","disabled","htmlFor","parseFloat","isNaN","min","max","step","split","required","index","_marks$selectedStuden5","_marks$selectedStuden6","rowSpan","length","colSpan","textAlign","_marks$selectedStuden7","_marks$selectedStuden8","toFixed","weekday"],"sources":["/Users/irakizagaius/Downloads/IshuriHub/frontend/src/components/StudentDetails.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport '@fortawesome/fontawesome-free/css/all.min.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBell, faUsers, faGraduationCap, faCalendarAlt, faUserCheck, faUserGraduate, faBars, faDownload, faDashboard, faSignOut, faCalendarCheck, faCog } from '@fortawesome/free-solid-svg-icons';\nimport { Link, useParams} from 'react-router-dom';\nimport './StudentDetails.css';\nimport { getSubjects, getStudent, getTerms, addMarks, getMarks, getAttendance, addAttendance } from '../api';\n\nconst StudentDetailsPage = () => {\n  const { id } = useParams();\n  const [subjects, setSubjects] = useState([]);\n  const [marks, setMarks] = useState({});\n  const [currentTerm, setCurrentTerm] = useState(null);\n  const [isMarksModalOpen, setIsMarksModalOpen] = useState(false);\n  const [selectedStudent, setSelectedStudent] = useState(null);\n  const [newMarkData, setNewMarkData] = useState({\n    subject: '',\n    testType: '',\n    markPercentage: ''\n  });\n  const [attendance, setAttendance] = useState([]);\n  const [isAttendanceModalOpen, setIsAttendanceModalOpen] = useState(false);\n  const [newAttendance, setNewAttendance] = useState({\n    date: '',\n    status: '',\n  });\n  const formatDate = (dateString) => {\n    const options = { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };\n    return new Date(dateString).toLocaleDateString(undefined, options);}\n\n  // Retrieve user data from localStorage\n  const username = localStorage.getItem('username');\n  const email = localStorage.getItem('email');\n\n  const [terms, setTerms] = useState([]);\n  // Side menu state\n  const [menuOpen, setMenuOpen] = useState(false);\n  // State for the notification message\nconst [notification, setNotification] = useState({ message: '', type: '' });\n  \n  // Profile dropdown state\n  const [showProfileDropdown, setShowProfileDropdown] = useState(false);\n    // Handle profile dropdown toggle\n    const toggleProfileDropdown = () => {\n      setShowProfileDropdown(!showProfileDropdown);\n    };\n  \n    // Toggle side menu\n    const toggleMenu = () => {\n      setMenuOpen(!menuOpen);\n    };\n    \n    const closeNotification = () => {\n      setNotification({ message: '', type: '' });\n    };\n    // Logout function\n    const handleLogout = async () => {\n      try {\n        await logout();\n        localStorage.removeItem('username');\n        localStorage.removeItem('email');\n        // Redirect to the index page\n        window.location.href = '/';\n      } catch (error) {\n        console.error(\"Logout failed:\", error);\n      }\n    };\n\n\n    const fetchMarksForStudent = async () => {\n      try {\n        const rawMarks = await getMarks(selectedStudent.id, currentTerm.id);\n\n        const structuredMarks = rawMarks.reduce((acc, mark) => {\n          const { StudentId, Subject, testType, marks } = mark;\n    \n          if (!acc[StudentId]) acc[StudentId] = {};\n          if (!acc[StudentId][currentTerm.id]) acc[StudentId][currentTerm.id] = {};\n          if (!acc[StudentId][currentTerm.id][Subject.name]) {\n            acc[StudentId][currentTerm.id][Subject.name] = { test: 0, exam: 0 };\n          }\n    \n          acc[StudentId][currentTerm.id][Subject.name][testType] = marks;\n    \n          return acc;\n        }, {});\n    \n        setMarks(structuredMarks);\n      } catch (error) {\n        console.error(\"Error fetching marks:\", error);\n      }\n    };\n    \n    \nuseEffect(() => {\n    const fetchAttendance = async () => {\n      if (!selectedStudent || !currentTerm) return;\n      try {\n        const attendanceData = await getAttendance(selectedStudent.id, currentTerm.id);\n        setAttendance(attendanceData);\n      } catch (error) {\n        console.error(\"Error fetching attendance:\", error);\n      }\n    };\n\n    fetchAttendance();\n  }, [selectedStudent, currentTerm]);\n// Handle attendance submission\nconst handleAttendanceSubmit = async (e) => {\n  e.preventDefault();\n  try {\n    const recordedAttendance = await addAttendance({\n      studentId: selectedStudent.id,\n      termId: currentTerm.id,\n      date: newAttendance.date,\n      status: newAttendance.status,\n    });\n    setAttendance((prev) => [\n      ...prev,\n      recordedAttendance,\n    ]);\n    setIsAttendanceModalOpen(false); \n    setNotification({ message: 'Attendance recorded successfully!', type: 'success' });\n    setNewAttendance({ date: '', status: '' });\n  } catch (error) {\n    console.error(\"Error recording attendance:\", error);\n  }\n};\n\nconst displayedAttendance = attendance.filter(\n  (entry) => \n    entry.studentId === selectedStudent?.id && \n    entry.termId === currentTerm?.id\n);\n\n  useEffect(() => {\n    const fetchInitialData = async () => {\n      try {\n        const student = await getStudent(id);\n        setSelectedStudent(student);\n\n        const subjects = await getSubjects();\n        setSubjects(subjects);\n\n        const termDetails = await getTerms();\n        setTerms(termDetails);\n        const now = new Date();\n\n        const activeTerm = termDetails.find(\n          (term) => new Date(term.startDate) <= now && now <= new Date(term.endDate)\n        );\n        setCurrentTerm(activeTerm || termDetails[0]);\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      }\n    };\n\n    fetchInitialData();\n  }, [id]);\n\n  const handleSubjectChange = (e) => {\n    const selectedSubject = subjects.find(subject => subject.name === e.target.value);\n    setNewMarkData({\n      ...newMarkData,\n      subject: selectedSubject\n    });\n  };\n\n  const handleMarksSubmit = async (e) => {\n    e.preventDefault();\n  if (!selectedStudent || !newMarkData.subject || !newMarkData.subject.id) {\n    return;\n  }\n  \n    try {\n      await addMarks({\n        studentId: selectedStudent.id,\n        subjectId: newMarkData.subject.id,\n        testType: newMarkData.testType,\n        marks: newMarkData.markPercentage,\n    });\n      await fetchMarksForStudent();\n      setIsMarksModalOpen(false);\n      setNotification({ message: 'Marks added successfully!', type: 'success' });\n      setNewMarkData({ subject: '', testType: '', markPercentage: '' });\n\n    } catch (error) {\n      console.error('Error adding marks:', error);\n    }\n  };\n\n\n  useEffect(() => {\n    if (selectedStudent && currentTerm) {\n      fetchMarksForStudent();\n    }\n  }, [selectedStudent, currentTerm]);\n  \n  const calculateSubjectTotal = (subjectMarks) => {\n    const testMarks = subjectMarks?.test || 0;\n    const examMarks = subjectMarks?.exam || 0;\n    return (testMarks + examMarks) / 2; \n  };\n\n  const handleExportReport = () => {\n    if (!selectedStudent || !currentTerm) {\n      alert(\"No data available to export.\");\n      return;\n    }\n  \n\n    const headers = [\"Student Name\", \"Subject\", \"Test\", \"Exam\", \"Term Total\"];\n    \n\n    const rows = subjects.map((subject) => {\n      const subjectMarks = marks[selectedStudent.id]?.[currentTerm.id]?.[subject.name] || {};\n      const testMarks = subjectMarks.test || \"-\";\n      const examMarks = subjectMarks.exam || \"-\";\n      const subjectTotal = calculateSubjectTotal(subjectMarks);\n      return [\n        selectedStudent.name, \n        subject.name, \n        testMarks, \n        examMarks, \n        subjectTotal || \"-\"\n      ];\n    });\n  \n\n    const overallTotal = subjects.reduce((total, subject) => {\n      const subjectMarks = marks[selectedStudent.id]?.[currentTerm.id]?.[subject.name] || {};\n      return total + calculateSubjectTotal(subjectMarks);\n    }, 0);\n  \n\n    rows.push([\"\", \"Overall Total\", \"\", \"\", overallTotal]);\n  \n\n    const csvContent = [headers, ...rows]\n      .map((row) => row.join(\",\"))\n      .join(\"\\n\");\n\n    const blob = new Blob([csvContent], { type: \"text/csv\" });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement(\"a\");\n    link.href = url;\n    link.download = `report_${currentTerm.name}_${selectedStudent.name}.csv`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n  \n  return (\n    <div className=\"StudentDetails-wrapper\">\n     {/* Side Menu */}\n<div className={`side-menu ${menuOpen ? 'open' : ''}`}>\n  <button className=\"menu-toggle\" onClick={toggleMenu}>\n    <FontAwesomeIcon icon={faBars} />\n  </button>\n  {/* Menu Icons */}\n  <div className=\"menu-icons\">\n  <ul>\n        <li><Link to=\"/dashboard\"><FontAwesomeIcon icon={faDashboard} className=\"Dashboard-icon\" /> {menuOpen && <span>Dashboard</span>}</Link></li>\n        <li><Link to=\"/students\"><FontAwesomeIcon icon={faGraduationCap} className=\"Students-icon\" /> {menuOpen && <span>Students</span>}</Link></li>\n        <li><Link to=\"/events\"><FontAwesomeIcon icon={faCalendarAlt} className=\"Events-icon\" /> {menuOpen && <span>Events</span>}</Link></li>\n        <li><Link to=\"/parents\"><FontAwesomeIcon icon={faUsers} className=\"Parents-icon\" /> {menuOpen && <span>Parents</span>}</Link></li>\n        <li><Link to=\"/config\"><FontAwesomeIcon icon={faCog} className=\"Config-icon\" /> {menuOpen && <span>Configurations</span>}</Link></li>\n        <li onClick={toggleProfileDropdown}><FontAwesomeIcon icon={faUserCheck} className=\"Profile-icon\" style={{ color: 'white' }} />{menuOpen && <span>Profile</span>}</li>\n        <li onClick={handleLogout}><FontAwesomeIcon icon={faSignOut} className=\"Register-icon\" style={{ color: 'white' }} />{menuOpen && <span>Logout</span>}</li>\n      </ul>\n  </div>\n</div>\n{/* Main Content */}\n<div className={`StudentDetails-container ${menuOpen ? 'blur' : ''}`}>\n                 {/* Notification */}\n                 {notification.message && (\n        <div className={`notification ${notification.type}`} style={{ top: notification.message ? '100px' : '-60px' }}>\n          {notification.message}\n        </div>\n      )}\n\n      {/* Close Notification after 3 seconds */}\n      {notification.message && setTimeout(closeNotification, 3000)}\n\n        {/* Header Section */}\n        <header className=\"StudentDetails-header\">\n          <h1 className=\"StudentDetails-title\">Student Details</h1>\n        </header>\n        {/* Profile Icon */}\n        <div className=\"profile-container\" onClick={toggleProfileDropdown}>\n            <FontAwesomeIcon icon={faUserCheck} className=\"profile-icon\" />\n            {/* Profile Dropdown */}\n            {showProfileDropdown && (\n              <div className=\"profile-dropdown\">\n                <p><strong>UserName: {username}</strong></p>\n                <p><strong>Email: {email}</strong></p>\n                <button className=\"logout-button\" onClick={handleLogout}>Logout</button>\n              </div>\n            )}\n          </div>\n    <div className=\"student-details-container\">\n      <h1>{currentTerm ? `Current Term: ${currentTerm.name}` : 'No Active Term'}</h1>\n\n      {/* Add Marks Button */}\n      <div className=\"add-marks-button-container\">\n        <button className=\"add-marks-button\" onClick={() => setIsMarksModalOpen(true)}> + Add Marks</button>\n      </div>\n      {/* Export Report Button */}\n      <button className=\"export-report-button\" onClick={handleExportReport}>\n        <FontAwesomeIcon icon={faDownload} /> Export</button>\n      {/* Add Marks Modal */}\n      {isMarksModalOpen && (\n        <div className=\"marks-popup-form\">\n          <div className=\"marks-form-container\">\n            <h2>Add Marks for {selectedStudent?.name}</h2>\n            <form onSubmit={handleMarksSubmit}>\n              <div className=\"marks-form-group\">\n                <label>Subject</label>\n                <select\n                  value={newMarkData.subject ? newMarkData.subject.name : \"\"}  \n                  onChange={handleSubjectChange}\n                >\n                  <option value=\"\" disabled>Select Subject</option>\n                  {subjects.map((subject) => (\n                    <option key={subject.id} value={subject.name}>\n                      {subject.name}\n                    </option>\n                  ))}\n                </select>\n              </div>\n              <div className=\"marks-form-group\">\n  <label htmlFor=\"testType\">Test Type</label>\n  <select\n    id=\"testType\"\n    value={newMarkData.testType || \"\"}\n    onChange={(e) =>\n      setNewMarkData({ ...newMarkData, testType: e.target.value })\n    }\n  >\n    <option value=\"\" disabled>Select Test Type</option>\n    <option value=\"test\">Test</option>\n    <option value=\"exam\">Exam</option>\n  </select>\n</div>\n\n<div className=\"marks-form-group\">\n  <label>Mark Percentage</label>\n  <input\n    type=\"number\"\n    value={newMarkData.markPercentage}\n    onChange={(e) => {\n      // Convert input value to a float number and set it\n      const value = parseFloat(e.target.value);\n      \n      // Check if the value is a valid number (NaN is returned for invalid inputs)\n      if (!isNaN(value) && value >= 0 && value <= 100) {\n        setNewMarkData({ ...newMarkData, markPercentage: value });\n      }\n    }}\n    min=\"0\"\n    max=\"100\"\n    step=\"0.01\"  // Allow float input by defining step\n  />\n</div>\n\n              <div className=\"marks-form-actions\">\n          <button type=\"submit\" className=\"btn btn-primary\">Save</button>\n        </div>\n        \n            </form>\n            <div className='marks-form-close'>\n      <button className=\"btn btn-close\" onClick={() => { \n        setNewMarkData({ subject: \"\", testType: \"\", markPercentage: \"\" }); \n        setIsMarksModalOpen(false);}}></button>\n      </div>\n          </div>\n        </div>\n      )}\n{isAttendanceModalOpen && (\n  <div className=\"attendance-popup-form\">\n    <div className=\"attendance-form-container\">\n      <h2>Attendance for {selectedStudent?.name}</h2>\n      <form onSubmit={handleAttendanceSubmit}>\n        <div className=\"attendance-form-group\">\n          <label>Date</label>\n          <input\n            type=\"date\"\n            value={newAttendance.date || \"\"}\n            min={currentTerm?.startDate.split('T')[0]} \n            max={currentTerm?.endDate.split('T')[0]}\n            onChange={(e) =>\n              setNewAttendance({\n                ...newAttendance,\n                date: e.target.value,\n              })\n            }\n            required\n          />\n        </div>\n\n        <div className=\"attendance-form-group\">\n          <label>Status</label>\n          <select\n            value={newAttendance.status || \"\"}\n            onChange={(e) =>\n              setNewAttendance({\n                ...newAttendance,\n                status: e.target.value,\n              })\n            }\n            required\n          >\n            <option value=\"\" disabled>Select Status</option>\n            <option value=\"PRESENT\">PRESENT</option>\n            <option value=\"ABSENT\">ABSENT</option>\n          </select>\n        </div>\n\n        <div className=\"attendance-form-actions\">\n          <button type=\"submit\" className=\"btn btn-primary\">Save</button>\n        </div>\n      </form>\n      <div className=\"attendance-form-close\">\n        <button\n          className=\"btn btn-close\"\n          onClick={() => {\n            setNewAttendance({ date: \"\", status: \"\" });\n            setIsAttendanceModalOpen(false);\n          }}\n        ></button>\n      </div>\n    </div>\n  </div>\n)}\n\n      {/* Term Report Table */}\n      {currentTerm ? (\n  <div className=\"term-report\">\n    <h2>Report for {currentTerm.name}</h2>\n    <p>Duration: {formatDate(currentTerm.startDate)} To {formatDate(currentTerm.endDate)}</p>\n\n    <table>\n      <thead>\n        <tr>\n          <th>Student Name</th>\n          <th>Subject</th>\n          <th> Test (%)</th>\n          <th>Exam (%)</th>\n          <th>Term Total(%)</th>\n        </tr>\n      </thead>\n      <tbody>\n        {subjects.map((subject, index) => {\n          const subjectMarks = marks[selectedStudent?.id]?.[currentTerm?.id]?.[subject.name] || {};\n          const subjectTotal = calculateSubjectTotal(subjectMarks);\n          return (\n            <tr key={`${selectedStudent.id}-${subject.id}`}>\n              {index === 0 && (\n                <td rowSpan={subjects.length}>{selectedStudent.name}</td>\n              )}\n              <td>{subject.name}</td>\n              <td>{subjectMarks.test || '-'}</td>\n              <td>{subjectMarks.exam || '-'}</td>\n              <td>{subjectTotal || '-'}</td>\n            </tr>\n          );\n        })}\n      </tbody>\n      <tfoot>\n      <tr>\n  <td colSpan=\"4\" style={{ textAlign: 'right' }}>Overall Total</td>\n  <td>\n    {parseFloat(\n      (\n        subjects.reduce((total, subject) => {\n          const subjectMarks =\n            marks[selectedStudent?.id]?.[currentTerm?.id]?.[subject.name] || {};\n          return total + calculateSubjectTotal(subjectMarks);\n        }, 0) / 14\n      ).toFixed(2)\n    )}%\n  </td>\n</tr>\n      </tfoot>\n    </table>\n  </div>\n) : (\n  <p>No active term is currently ongoing.</p>\n)}\n\n\n{/* Attendance Table */}\n<div className=\"attendance-section\">\n        <h2>Attendance for {currentTerm?.name}</h2>\n\n        {/* Attendance Table */}\n        <table>\n          <thead>\n            <tr>\n              <th>Date</th>\n              <th>Status</th>\n            </tr>\n          </thead>\n          <tbody>\n    {displayedAttendance.length > 0 ? (\n      displayedAttendance.map((entry, index) => (\n        <tr key={index}>\n          <td>         \n            {new Date(entry.date).toLocaleDateString('en-US', {\n            weekday: 'short', // E.g., \"Thu\"\n            year: 'numeric',\n            month: 'long', // E.g., \"November\"\n            day: '2-digit',\n          })}\n          </td>\n          <td style={{ color: entry.status === 'PRESENT' ? 'green' : 'red' }}>\n            {entry.status}</td> \n        </tr>\n      ))\n    ) : (\n      <tr>\n        <td colSpan=\"2\">No attendance records found.</td>\n      </tr>\n    )}\n  </tbody>\n        </table>\n\n        {/* Add Attendance Button */}\n        <button className=\"record-attendance-button\" onClick={() => setIsAttendanceModalOpen(true)}> + Record Attendance</button>\n\n      </div>\n    </div>\n    </div>\n    </div>\n  );\n}\n\n\nexport default StudentDetailsPage;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,sCAAsC,CAC7C,MAAO,+CAA+C,CACtD,OAASC,eAAe,KAAQ,gCAAgC,CAChE,OAASC,MAAM,CAAEC,OAAO,CAAEC,eAAe,CAAEC,aAAa,CAAEC,WAAW,CAAEC,cAAc,CAAEC,MAAM,CAAEC,UAAU,CAAEC,WAAW,CAAEC,SAAS,CAAEC,eAAe,CAAEC,KAAK,KAAQ,mCAAmC,CACpM,OAASC,IAAI,CAAEC,SAAS,KAAO,kBAAkB,CACjD,MAAO,sBAAsB,CAC7B,OAASC,WAAW,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,QAAQ,CAAEC,QAAQ,CAAEC,aAAa,CAAEC,aAAa,KAAQ,QAAQ,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE7G,KAAM,CAAAC,kBAAkB,CAAGA,CAAA,GAAM,CAC/B,KAAM,CAAEC,EAAG,CAAC,CAAGb,SAAS,CAAC,CAAC,CAC1B,KAAM,CAACc,QAAQ,CAAEC,WAAW,CAAC,CAAG/B,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACgC,KAAK,CAAEC,QAAQ,CAAC,CAAGjC,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtC,KAAM,CAACkC,WAAW,CAAEC,cAAc,CAAC,CAAGnC,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAACoC,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGrC,QAAQ,CAAC,KAAK,CAAC,CAC/D,KAAM,CAACsC,eAAe,CAAEC,kBAAkB,CAAC,CAAGvC,QAAQ,CAAC,IAAI,CAAC,CAC5D,KAAM,CAACwC,WAAW,CAAEC,cAAc,CAAC,CAAGzC,QAAQ,CAAC,CAC7C0C,OAAO,CAAE,EAAE,CACXC,QAAQ,CAAE,EAAE,CACZC,cAAc,CAAE,EAClB,CAAC,CAAC,CACF,KAAM,CAACC,UAAU,CAAEC,aAAa,CAAC,CAAG9C,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAAC+C,qBAAqB,CAAEC,wBAAwB,CAAC,CAAGhD,QAAQ,CAAC,KAAK,CAAC,CACzE,KAAM,CAACiD,aAAa,CAAEC,gBAAgB,CAAC,CAAGlD,QAAQ,CAAC,CACjDmD,IAAI,CAAE,EAAE,CACRC,MAAM,CAAE,EACV,CAAC,CAAC,CACF,KAAM,CAAAC,UAAU,CAAIC,UAAU,EAAK,CACjC,KAAM,CAAAC,OAAO,CAAG,CAAEC,IAAI,CAAE,SAAS,CAAEC,KAAK,CAAE,MAAM,CAAEC,GAAG,CAAE,SAAS,CAAEC,IAAI,CAAE,SAAS,CAAEC,MAAM,CAAE,SAAU,CAAC,CACtG,MAAO,IAAI,CAAAC,IAAI,CAACP,UAAU,CAAC,CAACQ,kBAAkB,CAACC,SAAS,CAAER,OAAO,CAAC,CAAC,CAAC,CAEtE;AACA,KAAM,CAAAS,QAAQ,CAAGC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,CACjD,KAAM,CAAAC,KAAK,CAAGF,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,KAAM,CAACE,KAAK,CAAEC,QAAQ,CAAC,CAAGrE,QAAQ,CAAC,EAAE,CAAC,CACtC;AACA,KAAM,CAACsE,QAAQ,CAAEC,WAAW,CAAC,CAAGvE,QAAQ,CAAC,KAAK,CAAC,CAC/C;AACF,KAAM,CAACwE,YAAY,CAAEC,eAAe,CAAC,CAAGzE,QAAQ,CAAC,CAAE0E,OAAO,CAAE,EAAE,CAAEC,IAAI,CAAE,EAAG,CAAC,CAAC,CAEzE;AACA,KAAM,CAACC,mBAAmB,CAAEC,sBAAsB,CAAC,CAAG7E,QAAQ,CAAC,KAAK,CAAC,CACnE;AACA,KAAM,CAAA8E,qBAAqB,CAAGA,CAAA,GAAM,CAClCD,sBAAsB,CAAC,CAACD,mBAAmB,CAAC,CAC9C,CAAC,CAED;AACA,KAAM,CAAAG,UAAU,CAAGA,CAAA,GAAM,CACvBR,WAAW,CAAC,CAACD,QAAQ,CAAC,CACxB,CAAC,CAED,KAAM,CAAAU,iBAAiB,CAAGA,CAAA,GAAM,CAC9BP,eAAe,CAAC,CAAEC,OAAO,CAAE,EAAE,CAAEC,IAAI,CAAE,EAAG,CAAC,CAAC,CAC5C,CAAC,CACD;AACA,KAAM,CAAAM,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACF,KAAM,CAAAC,MAAM,CAAC,CAAC,CACdjB,YAAY,CAACkB,UAAU,CAAC,UAAU,CAAC,CACnClB,YAAY,CAACkB,UAAU,CAAC,OAAO,CAAC,CAChC;AACAC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,GAAG,CAC5B,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,gBAAgB,CAAEA,KAAK,CAAC,CACxC,CACF,CAAC,CAGD,KAAM,CAAAE,oBAAoB,CAAG,KAAAA,CAAA,GAAY,CACvC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAArE,QAAQ,CAACiB,eAAe,CAACT,EAAE,CAAEK,WAAW,CAACL,EAAE,CAAC,CAEnE,KAAM,CAAA8D,eAAe,CAAGD,QAAQ,CAACE,MAAM,CAAC,CAACC,GAAG,CAAEC,IAAI,GAAK,CACrD,KAAM,CAAEC,SAAS,CAAEC,OAAO,CAAErD,QAAQ,CAAEX,KAAM,CAAC,CAAG8D,IAAI,CAEpD,GAAI,CAACD,GAAG,CAACE,SAAS,CAAC,CAAEF,GAAG,CAACE,SAAS,CAAC,CAAG,CAAC,CAAC,CACxC,GAAI,CAACF,GAAG,CAACE,SAAS,CAAC,CAAC7D,WAAW,CAACL,EAAE,CAAC,CAAEgE,GAAG,CAACE,SAAS,CAAC,CAAC7D,WAAW,CAACL,EAAE,CAAC,CAAG,CAAC,CAAC,CACxE,GAAI,CAACgE,GAAG,CAACE,SAAS,CAAC,CAAC7D,WAAW,CAACL,EAAE,CAAC,CAACmE,OAAO,CAACC,IAAI,CAAC,CAAE,CACjDJ,GAAG,CAACE,SAAS,CAAC,CAAC7D,WAAW,CAACL,EAAE,CAAC,CAACmE,OAAO,CAACC,IAAI,CAAC,CAAG,CAAEC,IAAI,CAAE,CAAC,CAAEC,IAAI,CAAE,CAAE,CAAC,CACrE,CAEAN,GAAG,CAACE,SAAS,CAAC,CAAC7D,WAAW,CAACL,EAAE,CAAC,CAACmE,OAAO,CAACC,IAAI,CAAC,CAACtD,QAAQ,CAAC,CAAGX,KAAK,CAE9D,MAAO,CAAA6D,GAAG,CACZ,CAAC,CAAE,CAAC,CAAC,CAAC,CAEN5D,QAAQ,CAAC0D,eAAe,CAAC,CAC3B,CAAE,MAAOJ,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC/C,CACF,CAAC,CAGLtF,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAmG,eAAe,CAAG,KAAAA,CAAA,GAAY,CAClC,GAAI,CAAC9D,eAAe,EAAI,CAACJ,WAAW,CAAE,OACtC,GAAI,CACF,KAAM,CAAAmE,cAAc,CAAG,KAAM,CAAA/E,aAAa,CAACgB,eAAe,CAACT,EAAE,CAAEK,WAAW,CAACL,EAAE,CAAC,CAC9EiB,aAAa,CAACuD,cAAc,CAAC,CAC/B,CAAE,MAAOd,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CACpD,CACF,CAAC,CAEDa,eAAe,CAAC,CAAC,CACnB,CAAC,CAAE,CAAC9D,eAAe,CAAEJ,WAAW,CAAC,CAAC,CACpC;AACA,KAAM,CAAAoE,sBAAsB,CAAG,KAAO,CAAAC,CAAC,EAAK,CAC1CA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,GAAI,CACF,KAAM,CAAAC,kBAAkB,CAAG,KAAM,CAAAlF,aAAa,CAAC,CAC7CmF,SAAS,CAAEpE,eAAe,CAACT,EAAE,CAC7B8E,MAAM,CAAEzE,WAAW,CAACL,EAAE,CACtBsB,IAAI,CAAEF,aAAa,CAACE,IAAI,CACxBC,MAAM,CAAEH,aAAa,CAACG,MACxB,CAAC,CAAC,CACFN,aAAa,CAAE8D,IAAI,EAAK,CACtB,GAAGA,IAAI,CACPH,kBAAkB,CACnB,CAAC,CACFzD,wBAAwB,CAAC,KAAK,CAAC,CAC/ByB,eAAe,CAAC,CAAEC,OAAO,CAAE,mCAAmC,CAAEC,IAAI,CAAE,SAAU,CAAC,CAAC,CAClFzB,gBAAgB,CAAC,CAAEC,IAAI,CAAE,EAAE,CAAEC,MAAM,CAAE,EAAG,CAAC,CAAC,CAC5C,CAAE,MAAOmC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACrD,CACF,CAAC,CAED,KAAM,CAAAsB,mBAAmB,CAAGhE,UAAU,CAACiE,MAAM,CAC1CC,KAAK,EACJA,KAAK,CAACL,SAAS,IAAKpE,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAET,EAAE,GACvCkF,KAAK,CAACJ,MAAM,IAAKzE,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEL,EAAE,CACpC,CAAC,CAEC5B,SAAS,CAAC,IAAM,CACd,KAAM,CAAA+G,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,GAAI,CACF,KAAM,CAAAC,OAAO,CAAG,KAAM,CAAA/F,UAAU,CAACW,EAAE,CAAC,CACpCU,kBAAkB,CAAC0E,OAAO,CAAC,CAE3B,KAAM,CAAAnF,QAAQ,CAAG,KAAM,CAAAb,WAAW,CAAC,CAAC,CACpCc,WAAW,CAACD,QAAQ,CAAC,CAErB,KAAM,CAAAoF,WAAW,CAAG,KAAM,CAAA/F,QAAQ,CAAC,CAAC,CACpCkD,QAAQ,CAAC6C,WAAW,CAAC,CACrB,KAAM,CAAAC,GAAG,CAAG,GAAI,CAAAtD,IAAI,CAAC,CAAC,CAEtB,KAAM,CAAAuD,UAAU,CAAGF,WAAW,CAACG,IAAI,CAChCC,IAAI,EAAK,GAAI,CAAAzD,IAAI,CAACyD,IAAI,CAACC,SAAS,CAAC,EAAIJ,GAAG,EAAIA,GAAG,EAAI,GAAI,CAAAtD,IAAI,CAACyD,IAAI,CAACE,OAAO,CAC3E,CAAC,CACDrF,cAAc,CAACiF,UAAU,EAAIF,WAAW,CAAC,CAAC,CAAC,CAAC,CAC9C,CAAE,MAAO3B,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC9C,CACF,CAAC,CAEDyB,gBAAgB,CAAC,CAAC,CACpB,CAAC,CAAE,CAACnF,EAAE,CAAC,CAAC,CAER,KAAM,CAAA4F,mBAAmB,CAAIlB,CAAC,EAAK,CACjC,KAAM,CAAAmB,eAAe,CAAG5F,QAAQ,CAACuF,IAAI,CAAC3E,OAAO,EAAIA,OAAO,CAACuD,IAAI,GAAKM,CAAC,CAACoB,MAAM,CAACC,KAAK,CAAC,CACjFnF,cAAc,CAAC,CACb,GAAGD,WAAW,CACdE,OAAO,CAAEgF,eACX,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAG,iBAAiB,CAAG,KAAO,CAAAtB,CAAC,EAAK,CACrCA,CAAC,CAACC,cAAc,CAAC,CAAC,CACpB,GAAI,CAAClE,eAAe,EAAI,CAACE,WAAW,CAACE,OAAO,EAAI,CAACF,WAAW,CAACE,OAAO,CAACb,EAAE,CAAE,CACvE,OACF,CAEE,GAAI,CACF,KAAM,CAAAT,QAAQ,CAAC,CACbsF,SAAS,CAAEpE,eAAe,CAACT,EAAE,CAC7BiG,SAAS,CAAEtF,WAAW,CAACE,OAAO,CAACb,EAAE,CACjCc,QAAQ,CAAEH,WAAW,CAACG,QAAQ,CAC9BX,KAAK,CAAEQ,WAAW,CAACI,cACvB,CAAC,CAAC,CACA,KAAM,CAAA6C,oBAAoB,CAAC,CAAC,CAC5BpD,mBAAmB,CAAC,KAAK,CAAC,CAC1BoC,eAAe,CAAC,CAAEC,OAAO,CAAE,2BAA2B,CAAEC,IAAI,CAAE,SAAU,CAAC,CAAC,CAC1ElC,cAAc,CAAC,CAAEC,OAAO,CAAE,EAAE,CAAEC,QAAQ,CAAE,EAAE,CAAEC,cAAc,CAAE,EAAG,CAAC,CAAC,CAEnE,CAAE,MAAO2C,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,qBAAqB,CAAEA,KAAK,CAAC,CAC7C,CACF,CAAC,CAGDtF,SAAS,CAAC,IAAM,CACd,GAAIqC,eAAe,EAAIJ,WAAW,CAAE,CAClCuD,oBAAoB,CAAC,CAAC,CACxB,CACF,CAAC,CAAE,CAACnD,eAAe,CAAEJ,WAAW,CAAC,CAAC,CAElC,KAAM,CAAA6F,qBAAqB,CAAIC,YAAY,EAAK,CAC9C,KAAM,CAAAC,SAAS,CAAG,CAAAD,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAE9B,IAAI,GAAI,CAAC,CACzC,KAAM,CAAAgC,SAAS,CAAG,CAAAF,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAE7B,IAAI,GAAI,CAAC,CACzC,MAAO,CAAC8B,SAAS,CAAGC,SAAS,EAAI,CAAC,CACpC,CAAC,CAED,KAAM,CAAAC,kBAAkB,CAAGA,CAAA,GAAM,CAC/B,GAAI,CAAC7F,eAAe,EAAI,CAACJ,WAAW,CAAE,CACpCkG,KAAK,CAAC,8BAA8B,CAAC,CACrC,OACF,CAGA,KAAM,CAAAC,OAAO,CAAG,CAAC,cAAc,CAAE,SAAS,CAAE,MAAM,CAAE,MAAM,CAAE,YAAY,CAAC,CAGzE,KAAM,CAAAC,IAAI,CAAGxG,QAAQ,CAACyG,GAAG,CAAE7F,OAAO,EAAK,KAAA8F,qBAAA,CAAAC,sBAAA,CACrC,KAAM,CAAAT,YAAY,CAAG,EAAAQ,qBAAA,CAAAxG,KAAK,CAACM,eAAe,CAACT,EAAE,CAAC,UAAA2G,qBAAA,kBAAAC,sBAAA,CAAzBD,qBAAA,CAA4BtG,WAAW,CAACL,EAAE,CAAC,UAAA4G,sBAAA,iBAA3CA,sBAAA,CAA8C/F,OAAO,CAACuD,IAAI,CAAC,GAAI,CAAC,CAAC,CACtF,KAAM,CAAAgC,SAAS,CAAGD,YAAY,CAAC9B,IAAI,EAAI,GAAG,CAC1C,KAAM,CAAAgC,SAAS,CAAGF,YAAY,CAAC7B,IAAI,EAAI,GAAG,CAC1C,KAAM,CAAAuC,YAAY,CAAGX,qBAAqB,CAACC,YAAY,CAAC,CACxD,MAAO,CACL1F,eAAe,CAAC2D,IAAI,CACpBvD,OAAO,CAACuD,IAAI,CACZgC,SAAS,CACTC,SAAS,CACTQ,YAAY,EAAI,GAAG,CACpB,CACH,CAAC,CAAC,CAGF,KAAM,CAAAC,YAAY,CAAG7G,QAAQ,CAAC8D,MAAM,CAAC,CAACgD,KAAK,CAAElG,OAAO,GAAK,KAAAmG,sBAAA,CAAAC,sBAAA,CACvD,KAAM,CAAAd,YAAY,CAAG,EAAAa,sBAAA,CAAA7G,KAAK,CAACM,eAAe,CAACT,EAAE,CAAC,UAAAgH,sBAAA,kBAAAC,sBAAA,CAAzBD,sBAAA,CAA4B3G,WAAW,CAACL,EAAE,CAAC,UAAAiH,sBAAA,iBAA3CA,sBAAA,CAA8CpG,OAAO,CAACuD,IAAI,CAAC,GAAI,CAAC,CAAC,CACtF,MAAO,CAAA2C,KAAK,CAAGb,qBAAqB,CAACC,YAAY,CAAC,CACpD,CAAC,CAAE,CAAC,CAAC,CAGLM,IAAI,CAACS,IAAI,CAAC,CAAC,EAAE,CAAE,eAAe,CAAE,EAAE,CAAE,EAAE,CAAEJ,YAAY,CAAC,CAAC,CAGtD,KAAM,CAAAK,UAAU,CAAG,CAACX,OAAO,CAAE,GAAGC,IAAI,CAAC,CAClCC,GAAG,CAAEU,GAAG,EAAKA,GAAG,CAACC,IAAI,CAAC,GAAG,CAAC,CAAC,CAC3BA,IAAI,CAAC,IAAI,CAAC,CAEb,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,IAAI,CAAC,CAACJ,UAAU,CAAC,CAAE,CAAErE,IAAI,CAAE,UAAW,CAAC,CAAC,CACzD,KAAM,CAAA0E,GAAG,CAAGC,GAAG,CAACC,eAAe,CAACJ,IAAI,CAAC,CACrC,KAAM,CAAAK,IAAI,CAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC,CACxCF,IAAI,CAAClE,IAAI,CAAG+D,GAAG,CACfG,IAAI,CAACG,QAAQ,CAAG,UAAUzH,WAAW,CAAC+D,IAAI,IAAI3D,eAAe,CAAC2D,IAAI,MAAM,CACxEwD,QAAQ,CAACG,IAAI,CAACC,WAAW,CAACL,IAAI,CAAC,CAC/BA,IAAI,CAACM,KAAK,CAAC,CAAC,CACZL,QAAQ,CAACG,IAAI,CAACG,WAAW,CAACP,IAAI,CAAC,CACjC,CAAC,CAED,mBACE7H,KAAA,QAAKqI,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eAE3CtI,KAAA,QAAKqI,SAAS,CAAE,aAAa1F,QAAQ,CAAG,MAAM,CAAG,EAAE,EAAG,CAAA2F,QAAA,eACpDxI,IAAA,WAAQuI,SAAS,CAAC,aAAa,CAACE,OAAO,CAAEnF,UAAW,CAAAkF,QAAA,cAClDxI,IAAA,CAACvB,eAAe,EAACiK,IAAI,CAAE1J,MAAO,CAAE,CAAC,CAC3B,CAAC,cAETgB,IAAA,QAAKuI,SAAS,CAAC,YAAY,CAAAC,QAAA,cAC3BtI,KAAA,OAAAsI,QAAA,eACMxI,IAAA,OAAAwI,QAAA,cAAItI,KAAA,CAACZ,IAAI,EAACqJ,EAAE,CAAC,YAAY,CAAAH,QAAA,eAACxI,IAAA,CAACvB,eAAe,EAACiK,IAAI,CAAExJ,WAAY,CAACqJ,SAAS,CAAC,gBAAgB,CAAE,CAAC,IAAC,CAAC1F,QAAQ,eAAI7C,IAAA,SAAAwI,QAAA,CAAM,WAAS,CAAM,CAAC,EAAO,CAAC,CAAI,CAAC,cAC5IxI,IAAA,OAAAwI,QAAA,cAAItI,KAAA,CAACZ,IAAI,EAACqJ,EAAE,CAAC,WAAW,CAAAH,QAAA,eAACxI,IAAA,CAACvB,eAAe,EAACiK,IAAI,CAAE9J,eAAgB,CAAC2J,SAAS,CAAC,eAAe,CAAE,CAAC,IAAC,CAAC1F,QAAQ,eAAI7C,IAAA,SAAAwI,QAAA,CAAM,UAAQ,CAAM,CAAC,EAAO,CAAC,CAAI,CAAC,cAC7IxI,IAAA,OAAAwI,QAAA,cAAItI,KAAA,CAACZ,IAAI,EAACqJ,EAAE,CAAC,SAAS,CAAAH,QAAA,eAACxI,IAAA,CAACvB,eAAe,EAACiK,IAAI,CAAE7J,aAAc,CAAC0J,SAAS,CAAC,aAAa,CAAE,CAAC,IAAC,CAAC1F,QAAQ,eAAI7C,IAAA,SAAAwI,QAAA,CAAM,QAAM,CAAM,CAAC,EAAO,CAAC,CAAI,CAAC,cACrIxI,IAAA,OAAAwI,QAAA,cAAItI,KAAA,CAACZ,IAAI,EAACqJ,EAAE,CAAC,UAAU,CAAAH,QAAA,eAACxI,IAAA,CAACvB,eAAe,EAACiK,IAAI,CAAE/J,OAAQ,CAAC4J,SAAS,CAAC,cAAc,CAAE,CAAC,IAAC,CAAC1F,QAAQ,eAAI7C,IAAA,SAAAwI,QAAA,CAAM,SAAO,CAAM,CAAC,EAAO,CAAC,CAAI,CAAC,cAClIxI,IAAA,OAAAwI,QAAA,cAAItI,KAAA,CAACZ,IAAI,EAACqJ,EAAE,CAAC,SAAS,CAAAH,QAAA,eAACxI,IAAA,CAACvB,eAAe,EAACiK,IAAI,CAAErJ,KAAM,CAACkJ,SAAS,CAAC,aAAa,CAAE,CAAC,IAAC,CAAC1F,QAAQ,eAAI7C,IAAA,SAAAwI,QAAA,CAAM,gBAAc,CAAM,CAAC,EAAO,CAAC,CAAI,CAAC,cACrItI,KAAA,OAAIuI,OAAO,CAAEpF,qBAAsB,CAAAmF,QAAA,eAACxI,IAAA,CAACvB,eAAe,EAACiK,IAAI,CAAE5J,WAAY,CAACyJ,SAAS,CAAC,cAAc,CAACK,KAAK,CAAE,CAAEC,KAAK,CAAE,OAAQ,CAAE,CAAE,CAAC,CAAChG,QAAQ,eAAI7C,IAAA,SAAAwI,QAAA,CAAM,SAAO,CAAM,CAAC,EAAK,CAAC,cACrKtI,KAAA,OAAIuI,OAAO,CAAEjF,YAAa,CAAAgF,QAAA,eAACxI,IAAA,CAACvB,eAAe,EAACiK,IAAI,CAAEvJ,SAAU,CAACoJ,SAAS,CAAC,eAAe,CAACK,KAAK,CAAE,CAAEC,KAAK,CAAE,OAAQ,CAAE,CAAE,CAAC,CAAChG,QAAQ,eAAI7C,IAAA,SAAAwI,QAAA,CAAM,QAAM,CAAM,CAAC,EAAK,CAAC,EACxJ,CAAC,CACJ,CAAC,EACH,CAAC,cAENtI,KAAA,QAAKqI,SAAS,CAAE,4BAA4B1F,QAAQ,CAAG,MAAM,CAAG,EAAE,EAAG,CAAA2F,QAAA,EAEnDzF,YAAY,CAACE,OAAO,eAC9BjD,IAAA,QAAKuI,SAAS,CAAE,gBAAgBxF,YAAY,CAACG,IAAI,EAAG,CAAC0F,KAAK,CAAE,CAAEE,GAAG,CAAE/F,YAAY,CAACE,OAAO,CAAG,OAAO,CAAG,OAAQ,CAAE,CAAAuF,QAAA,CAC3GzF,YAAY,CAACE,OAAO,CAClB,CACN,CAGAF,YAAY,CAACE,OAAO,EAAI8F,UAAU,CAACxF,iBAAiB,CAAE,IAAI,CAAC,cAG1DvD,IAAA,WAAQuI,SAAS,CAAC,uBAAuB,CAAAC,QAAA,cACvCxI,IAAA,OAAIuI,SAAS,CAAC,sBAAsB,CAAAC,QAAA,CAAC,iBAAe,CAAI,CAAC,CACnD,CAAC,cAETtI,KAAA,QAAKqI,SAAS,CAAC,mBAAmB,CAACE,OAAO,CAAEpF,qBAAsB,CAAAmF,QAAA,eAC9DxI,IAAA,CAACvB,eAAe,EAACiK,IAAI,CAAE5J,WAAY,CAACyJ,SAAS,CAAC,cAAc,CAAE,CAAC,CAE9DpF,mBAAmB,eAClBjD,KAAA,QAAKqI,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BxI,IAAA,MAAAwI,QAAA,cAAGtI,KAAA,WAAAsI,QAAA,EAAQ,YAAU,CAACjG,QAAQ,EAAS,CAAC,CAAG,CAAC,cAC5CvC,IAAA,MAAAwI,QAAA,cAAGtI,KAAA,WAAAsI,QAAA,EAAQ,SAAO,CAAC9F,KAAK,EAAS,CAAC,CAAG,CAAC,cACtC1C,IAAA,WAAQuI,SAAS,CAAC,eAAe,CAACE,OAAO,CAAEjF,YAAa,CAAAgF,QAAA,CAAC,QAAM,CAAQ,CAAC,EACrE,CACN,EACE,CAAC,cACZtI,KAAA,QAAKqI,SAAS,CAAC,2BAA2B,CAAAC,QAAA,eACxCxI,IAAA,OAAAwI,QAAA,CAAK/H,WAAW,CAAG,iBAAiBA,WAAW,CAAC+D,IAAI,EAAE,CAAG,gBAAgB,CAAK,CAAC,cAG/ExE,IAAA,QAAKuI,SAAS,CAAC,4BAA4B,CAAAC,QAAA,cACzCxI,IAAA,WAAQuI,SAAS,CAAC,kBAAkB,CAACE,OAAO,CAAEA,CAAA,GAAM7H,mBAAmB,CAAC,IAAI,CAAE,CAAA4H,QAAA,CAAC,cAAY,CAAQ,CAAC,CACjG,CAAC,cAENtI,KAAA,WAAQqI,SAAS,CAAC,sBAAsB,CAACE,OAAO,CAAE/B,kBAAmB,CAAA8B,QAAA,eACnExI,IAAA,CAACvB,eAAe,EAACiK,IAAI,CAAEzJ,UAAW,CAAE,CAAC,UAAO,EAAQ,CAAC,CAEtD0B,gBAAgB,eACfX,IAAA,QAAKuI,SAAS,CAAC,kBAAkB,CAAAC,QAAA,cAC/BtI,KAAA,QAAKqI,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eACnCtI,KAAA,OAAAsI,QAAA,EAAI,gBAAc,CAAC3H,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAE2D,IAAI,EAAK,CAAC,cAC9CtE,KAAA,SAAM8I,QAAQ,CAAE5C,iBAAkB,CAAAoC,QAAA,eAChCtI,KAAA,QAAKqI,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BxI,IAAA,UAAAwI,QAAA,CAAO,SAAO,CAAO,CAAC,cACtBtI,KAAA,WACEiG,KAAK,CAAEpF,WAAW,CAACE,OAAO,CAAGF,WAAW,CAACE,OAAO,CAACuD,IAAI,CAAG,EAAG,CAC3DyE,QAAQ,CAAEjD,mBAAoB,CAAAwC,QAAA,eAE9BxI,IAAA,WAAQmG,KAAK,CAAC,EAAE,CAAC+C,QAAQ,MAAAV,QAAA,CAAC,gBAAc,CAAQ,CAAC,CAChDnI,QAAQ,CAACyG,GAAG,CAAE7F,OAAO,eACpBjB,IAAA,WAAyBmG,KAAK,CAAElF,OAAO,CAACuD,IAAK,CAAAgE,QAAA,CAC1CvH,OAAO,CAACuD,IAAI,EADFvD,OAAO,CAACb,EAEb,CACT,CAAC,EACI,CAAC,EACN,CAAC,cACNF,KAAA,QAAKqI,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC7CxI,IAAA,UAAOmJ,OAAO,CAAC,UAAU,CAAAX,QAAA,CAAC,WAAS,CAAO,CAAC,cAC3CtI,KAAA,WACEE,EAAE,CAAC,UAAU,CACb+F,KAAK,CAAEpF,WAAW,CAACG,QAAQ,EAAI,EAAG,CAClC+H,QAAQ,CAAGnE,CAAC,EACV9D,cAAc,CAAC,CAAE,GAAGD,WAAW,CAAEG,QAAQ,CAAE4D,CAAC,CAACoB,MAAM,CAACC,KAAM,CAAC,CAC5D,CAAAqC,QAAA,eAEDxI,IAAA,WAAQmG,KAAK,CAAC,EAAE,CAAC+C,QAAQ,MAAAV,QAAA,CAAC,kBAAgB,CAAQ,CAAC,cACnDxI,IAAA,WAAQmG,KAAK,CAAC,MAAM,CAAAqC,QAAA,CAAC,MAAI,CAAQ,CAAC,cAClCxI,IAAA,WAAQmG,KAAK,CAAC,MAAM,CAAAqC,QAAA,CAAC,MAAI,CAAQ,CAAC,EAC5B,CAAC,EACN,CAAC,cAENtI,KAAA,QAAKqI,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BxI,IAAA,UAAAwI,QAAA,CAAO,iBAAe,CAAO,CAAC,cAC9BxI,IAAA,UACEkD,IAAI,CAAC,QAAQ,CACbiD,KAAK,CAAEpF,WAAW,CAACI,cAAe,CAClC8H,QAAQ,CAAGnE,CAAC,EAAK,CACf;AACA,KAAM,CAAAqB,KAAK,CAAGiD,UAAU,CAACtE,CAAC,CAACoB,MAAM,CAACC,KAAK,CAAC,CAExC;AACA,GAAI,CAACkD,KAAK,CAAClD,KAAK,CAAC,EAAIA,KAAK,EAAI,CAAC,EAAIA,KAAK,EAAI,GAAG,CAAE,CAC/CnF,cAAc,CAAC,CAAE,GAAGD,WAAW,CAAEI,cAAc,CAAEgF,KAAM,CAAC,CAAC,CAC3D,CACF,CAAE,CACFmD,GAAG,CAAC,GAAG,CACPC,GAAG,CAAC,KAAK,CACTC,IAAI,CAAC,MAAQ;AAAA,CACd,CAAC,EACC,CAAC,cAEQxJ,IAAA,QAAKuI,SAAS,CAAC,oBAAoB,CAAAC,QAAA,cACvCxI,IAAA,WAAQkD,IAAI,CAAC,QAAQ,CAACqF,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAAC,MAAI,CAAQ,CAAC,CAC5D,CAAC,EAEI,CAAC,cACPxI,IAAA,QAAKuI,SAAS,CAAC,kBAAkB,CAAAC,QAAA,cACvCxI,IAAA,WAAQuI,SAAS,CAAC,eAAe,CAACE,OAAO,CAAEA,CAAA,GAAM,CAC/CzH,cAAc,CAAC,CAAEC,OAAO,CAAE,EAAE,CAAEC,QAAQ,CAAE,EAAE,CAAEC,cAAc,CAAE,EAAG,CAAC,CAAC,CACjEP,mBAAmB,CAAC,KAAK,CAAC,CAAC,CAAE,CAAS,CAAC,CACpC,CAAC,EACG,CAAC,CACH,CACN,CACNU,qBAAqB,eACpBtB,IAAA,QAAKuI,SAAS,CAAC,uBAAuB,CAAAC,QAAA,cACpCtI,KAAA,QAAKqI,SAAS,CAAC,2BAA2B,CAAAC,QAAA,eACxCtI,KAAA,OAAAsI,QAAA,EAAI,iBAAe,CAAC3H,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAE2D,IAAI,EAAK,CAAC,cAC/CtE,KAAA,SAAM8I,QAAQ,CAAEnE,sBAAuB,CAAA2D,QAAA,eACrCtI,KAAA,QAAKqI,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eACpCxI,IAAA,UAAAwI,QAAA,CAAO,MAAI,CAAO,CAAC,cACnBxI,IAAA,UACEkD,IAAI,CAAC,MAAM,CACXiD,KAAK,CAAE3E,aAAa,CAACE,IAAI,EAAI,EAAG,CAChC4H,GAAG,CAAE7I,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEqF,SAAS,CAAC2D,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAE,CAC1CF,GAAG,CAAE9I,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEsF,OAAO,CAAC0D,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAE,CACxCR,QAAQ,CAAGnE,CAAC,EACVrD,gBAAgB,CAAC,CACf,GAAGD,aAAa,CAChBE,IAAI,CAAEoD,CAAC,CAACoB,MAAM,CAACC,KACjB,CAAC,CACF,CACDuD,QAAQ,MACT,CAAC,EACC,CAAC,cAENxJ,KAAA,QAAKqI,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eACpCxI,IAAA,UAAAwI,QAAA,CAAO,QAAM,CAAO,CAAC,cACrBtI,KAAA,WACEiG,KAAK,CAAE3E,aAAa,CAACG,MAAM,EAAI,EAAG,CAClCsH,QAAQ,CAAGnE,CAAC,EACVrD,gBAAgB,CAAC,CACf,GAAGD,aAAa,CAChBG,MAAM,CAAEmD,CAAC,CAACoB,MAAM,CAACC,KACnB,CAAC,CACF,CACDuD,QAAQ,MAAAlB,QAAA,eAERxI,IAAA,WAAQmG,KAAK,CAAC,EAAE,CAAC+C,QAAQ,MAAAV,QAAA,CAAC,eAAa,CAAQ,CAAC,cAChDxI,IAAA,WAAQmG,KAAK,CAAC,SAAS,CAAAqC,QAAA,CAAC,SAAO,CAAQ,CAAC,cACxCxI,IAAA,WAAQmG,KAAK,CAAC,QAAQ,CAAAqC,QAAA,CAAC,QAAM,CAAQ,CAAC,EAChC,CAAC,EACN,CAAC,cAENxI,IAAA,QAAKuI,SAAS,CAAC,yBAAyB,CAAAC,QAAA,cACtCxI,IAAA,WAAQkD,IAAI,CAAC,QAAQ,CAACqF,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAAC,MAAI,CAAQ,CAAC,CAC5D,CAAC,EACF,CAAC,cACPxI,IAAA,QAAKuI,SAAS,CAAC,uBAAuB,CAAAC,QAAA,cACpCxI,IAAA,WACEuI,SAAS,CAAC,eAAe,CACzBE,OAAO,CAAEA,CAAA,GAAM,CACbhH,gBAAgB,CAAC,CAAEC,IAAI,CAAE,EAAE,CAAEC,MAAM,CAAE,EAAG,CAAC,CAAC,CAC1CJ,wBAAwB,CAAC,KAAK,CAAC,CACjC,CAAE,CACK,CAAC,CACP,CAAC,EACH,CAAC,CACH,CACN,CAGMd,WAAW,cAChBP,KAAA,QAAKqI,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BtI,KAAA,OAAAsI,QAAA,EAAI,aAAW,CAAC/H,WAAW,CAAC+D,IAAI,EAAK,CAAC,cACtCtE,KAAA,MAAAsI,QAAA,EAAG,YAAU,CAAC5G,UAAU,CAACnB,WAAW,CAACqF,SAAS,CAAC,CAAC,MAAI,CAAClE,UAAU,CAACnB,WAAW,CAACsF,OAAO,CAAC,EAAI,CAAC,cAEzF7F,KAAA,UAAAsI,QAAA,eACExI,IAAA,UAAAwI,QAAA,cACEtI,KAAA,OAAAsI,QAAA,eACExI,IAAA,OAAAwI,QAAA,CAAI,cAAY,CAAI,CAAC,cACrBxI,IAAA,OAAAwI,QAAA,CAAI,SAAO,CAAI,CAAC,cAChBxI,IAAA,OAAAwI,QAAA,CAAI,WAAS,CAAI,CAAC,cAClBxI,IAAA,OAAAwI,QAAA,CAAI,UAAQ,CAAI,CAAC,cACjBxI,IAAA,OAAAwI,QAAA,CAAI,eAAa,CAAI,CAAC,EACpB,CAAC,CACA,CAAC,cACRxI,IAAA,UAAAwI,QAAA,CACGnI,QAAQ,CAACyG,GAAG,CAAC,CAAC7F,OAAO,CAAE0I,KAAK,GAAK,KAAAC,sBAAA,CAAAC,sBAAA,CAChC,KAAM,CAAAtD,YAAY,CAAG,EAAAqD,sBAAA,CAAArJ,KAAK,CAACM,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAET,EAAE,CAAC,UAAAwJ,sBAAA,kBAAAC,sBAAA,CAA1BD,sBAAA,CAA6BnJ,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEL,EAAE,CAAC,UAAAyJ,sBAAA,iBAA7CA,sBAAA,CAAgD5I,OAAO,CAACuD,IAAI,CAAC,GAAI,CAAC,CAAC,CACxF,KAAM,CAAAyC,YAAY,CAAGX,qBAAqB,CAACC,YAAY,CAAC,CACxD,mBACErG,KAAA,OAAAsI,QAAA,EACGmB,KAAK,GAAK,CAAC,eACV3J,IAAA,OAAI8J,OAAO,CAAEzJ,QAAQ,CAAC0J,MAAO,CAAAvB,QAAA,CAAE3H,eAAe,CAAC2D,IAAI,CAAK,CACzD,cACDxE,IAAA,OAAAwI,QAAA,CAAKvH,OAAO,CAACuD,IAAI,CAAK,CAAC,cACvBxE,IAAA,OAAAwI,QAAA,CAAKjC,YAAY,CAAC9B,IAAI,EAAI,GAAG,CAAK,CAAC,cACnCzE,IAAA,OAAAwI,QAAA,CAAKjC,YAAY,CAAC7B,IAAI,EAAI,GAAG,CAAK,CAAC,cACnC1E,IAAA,OAAAwI,QAAA,CAAKvB,YAAY,EAAI,GAAG,CAAK,CAAC,GAPvB,GAAGpG,eAAe,CAACT,EAAE,IAAIa,OAAO,CAACb,EAAE,EAQxC,CAAC,CAET,CAAC,CAAC,CACG,CAAC,cACRJ,IAAA,UAAAwI,QAAA,cACAtI,KAAA,OAAAsI,QAAA,eACJxI,IAAA,OAAIgK,OAAO,CAAC,GAAG,CAACpB,KAAK,CAAE,CAAEqB,SAAS,CAAE,OAAQ,CAAE,CAAAzB,QAAA,CAAC,eAAa,CAAI,CAAC,cACjEtI,KAAA,OAAAsI,QAAA,EACGY,UAAU,CACT,CACE/I,QAAQ,CAAC8D,MAAM,CAAC,CAACgD,KAAK,CAAElG,OAAO,GAAK,KAAAiJ,sBAAA,CAAAC,sBAAA,CAClC,KAAM,CAAA5D,YAAY,CAChB,EAAA2D,sBAAA,CAAA3J,KAAK,CAACM,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAET,EAAE,CAAC,UAAA8J,sBAAA,kBAAAC,sBAAA,CAA1BD,sBAAA,CAA6BzJ,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEL,EAAE,CAAC,UAAA+J,sBAAA,iBAA7CA,sBAAA,CAAgDlJ,OAAO,CAACuD,IAAI,CAAC,GAAI,CAAC,CAAC,CACrE,MAAO,CAAA2C,KAAK,CAAGb,qBAAqB,CAACC,YAAY,CAAC,CACpD,CAAC,CAAE,CAAC,CAAC,CAAG,EAAE,EACV6D,OAAO,CAAC,CAAC,CACb,CAAC,CAAC,GACJ,EAAI,CAAC,EACH,CAAC,CACQ,CAAC,EACH,CAAC,EACL,CAAC,cAENpK,IAAA,MAAAwI,QAAA,CAAG,sCAAoC,CAAG,CAC3C,cAIDtI,KAAA,QAAKqI,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eAC3BtI,KAAA,OAAAsI,QAAA,EAAI,iBAAe,CAAC/H,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE+D,IAAI,EAAK,CAAC,cAG3CtE,KAAA,UAAAsI,QAAA,eACExI,IAAA,UAAAwI,QAAA,cACEtI,KAAA,OAAAsI,QAAA,eACExI,IAAA,OAAAwI,QAAA,CAAI,MAAI,CAAI,CAAC,cACbxI,IAAA,OAAAwI,QAAA,CAAI,QAAM,CAAI,CAAC,EACb,CAAC,CACA,CAAC,cACRxI,IAAA,UAAAwI,QAAA,CACLpD,mBAAmB,CAAC2E,MAAM,CAAG,CAAC,CAC7B3E,mBAAmB,CAAC0B,GAAG,CAAC,CAACxB,KAAK,CAAEqE,KAAK,gBACnCzJ,KAAA,OAAAsI,QAAA,eACExI,IAAA,OAAAwI,QAAA,CACG,GAAI,CAAApG,IAAI,CAACkD,KAAK,CAAC5D,IAAI,CAAC,CAACW,kBAAkB,CAAC,OAAO,CAAE,CAClDgI,OAAO,CAAE,OAAO,CAAE;AAClBtI,IAAI,CAAE,SAAS,CACfC,KAAK,CAAE,MAAM,CAAE;AACfC,GAAG,CAAE,SACP,CAAC,CAAC,CACE,CAAC,cACLjC,IAAA,OAAI4I,KAAK,CAAE,CAAEC,KAAK,CAAEvD,KAAK,CAAC3D,MAAM,GAAK,SAAS,CAAG,OAAO,CAAG,KAAM,CAAE,CAAA6G,QAAA,CAChElD,KAAK,CAAC3D,MAAM,CAAK,CAAC,GAVdgI,KAWL,CACL,CAAC,cAEF3J,IAAA,OAAAwI,QAAA,cACExI,IAAA,OAAIgK,OAAO,CAAC,GAAG,CAAAxB,QAAA,CAAC,8BAA4B,CAAI,CAAC,CAC/C,CACL,CACI,CAAC,EACK,CAAC,cAGRxI,IAAA,WAAQuI,SAAS,CAAC,0BAA0B,CAACE,OAAO,CAAEA,CAAA,GAAMlH,wBAAwB,CAAC,IAAI,CAAE,CAAAiH,QAAA,CAAC,sBAAoB,CAAQ,CAAC,EAEtH,CAAC,EACH,CAAC,EACD,CAAC,EACD,CAAC,CAEV,CAAC,CAGD,cAAe,CAAArI,kBAAkB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}